<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Report Fault - Precision Drill (DRL8456) - ACME Manufacturing</title>

    <!-- Main Stylesheet -->
    <link rel="stylesheet" href="./static/css/main.css">
    <!-- Favicon -->
    <link rel="icon" type="image/svg" href="./static/images/favicon.svg">
    <!-- Font Awesome for icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>

<body>
    <!-- Navigation Bar -->
    <nav class="navbar">
        <div class="nav-container">
            <div class="menu-overlay"></div>
            <div class="side-menu">
                <div class="side-menu-header">
                    <img src="./static/images/favicon.svg" alt="Logo" class="menu-logo">
                    <span>ACME Manufacturing</span>
                    <button class="close-menu">×</button>
                </div>
                <div class="menu-sections">
                    <div class="menu-section">
                        <h3>Navigation</h3>
                        <a href="index.html">
                            <i class="fa-solid fa-gauge-high menu-icon"></i>
                            Dashboard
                        </a>
                        <a href="machinery.html">
                            <i class="fa-solid fa-gear menu-icon"></i>
                            Machinery
                        </a>
                        <a href="faults.html">
                            <i class="fa-solid fa-triangle-exclamation menu-icon"></i>
                            Fault Cases
                        </a>
                        <a href="collections.html">
                            <i class="fa-solid fa-folder menu-icon"></i>
                            Collections
                        </a>
                        <a href="reports.html">
                            <i class="fa-solid fa-chart-bar menu-icon"></i>
                            Reports
                        </a>
                    </div>

                    <div class="menu-section">
                        <h3>Management</h3>
                        <a href="users.html">
                            <i class="fa-solid fa-users menu-icon"></i>
                            Users
                        </a>
                        <a href="settings.html">
                            <i class="fa-solid fa-cog menu-icon"></i>
                            Settings
                        </a>
                        <a href="api-test.html">
                            <i class="fa-solid fa-code menu-icon"></i>
                            API Testing
                        </a>
                    </div>

                    <div class="menu-section">
                        <h3>Account</h3>
                        <a href="profile.html">
                            <i class="fa-solid fa-user menu-icon"></i>
                            Your Profile
                        </a>
                        <a href="login.html" class="logout-link">
                            <i class="fa-solid fa-right-from-bracket menu-icon"></i>
                            Logout
                        </a>
                    </div>
                </div>
            </div>

            <button class="menu-toggle">
                <span></span>
                <span></span>
                <span></span>
            </button>

            <!-- Logo and Title -->
            <div class="logo">
                <a href="index.html">
                    <img src="./static/images/favicon.svg" alt="ACME Logo">
                    <h1>ACME Manufacturing</h1>
                </a>
            </div>

            <!-- Navigation Links -->
            <div class="nav-links">
                <a class="hideable-nav-item" href="machinery.html">Machinery</a>
                <a class="hideable-nav-item" href="faults.html">Faults</a>
                <a class="hideable-nav-item" href="collections.html">Collections</a>

                <!-- Profile Dropdown for logged-in users -->
                <div class="profile-dropdown">
                    <div class="profile-trigger">
                        <div class="profile-icon">EA</div>
                    </div>
                    <div class="dropdown-content">
                        <a href="profile.html">My Profile</a>
                        <a href="settings.html">Settings</a>
                        <div class="dropdown-divider"></div>
                        <a href="login.html" class="logout-link">Logout</a>
                    </div>
                </div>
            </div>
        </div>
    </nav>

    <!-- Main Content -->
    <main class="main-container">
        <!-- Breadcrumb Navigation -->
        <div style="margin-bottom: 1rem;">
            <a href="machine-details.html?id=DRL8456" style="color: var(--text-light); text-decoration: none;">
                <i class="fa-solid fa-chevron-left"></i> Back to Machine Details
            </a>
        </div>

        <div class="machinery-list">
            <!-- Page Header -->
            <div>
                <h2>Report Fault: Precision Drill (DRL8456)</h2>
                <p style="color: var(--text-light);">
                    <i class="fa-solid fa-location-dot"></i> Building A, Room 101
                </p>
            </div>

            <!-- Fault Reporting Form -->
            <div class="form-container">
                <form id="fault-report-form">
                    <div class="form-group">
                        <label for="fault-title">Fault Title</label>
                        <input type="text" id="fault-title" name="fault-title"
                            placeholder="Brief description of the fault" required>
                    </div>

                    <div class="form-group">
                        <label for="fault-category">Fault Category</label>
                        <select id="fault-category" name="fault-category" required>
                            <option value="">Select a category</option>
                            <option value="mechanical">Mechanical Issue</option>
                            <option value="electrical">Electrical Issue</option>
                            <option value="software">Software/Control Issue</option>
                            <option value="calibration">Calibration Issue</option>
                            <option value="other">Other</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label for="fault-description">Detailed Description</label>
                        <textarea id="fault-description" name="fault-description" rows="5"
                            placeholder="Please provide a detailed description of the fault. Include when it started, any circumstances that might have caused it, and any troubleshooting already attempted."
                            required></textarea>
                    </div>

                    <div class="form-group">
                        <label for="fault-priority">Priority Level</label>
                        <select id="fault-priority" name="fault-priority" required>
                            <option value="">Select priority</option>
                            <option value="low">Low - Not urgent, can be scheduled</option>
                            <option value="medium">Medium - Needs attention soon</option>
                            <option value="high">High - Urgent repair needed</option>
                            <option value="critical">Critical - Production halted</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label>Images (optional)</label>
                        <div
                            style="border: 2px dashed var(--border-color); padding: 2rem; border-radius: 8px; text-align: center;">
                            <i class="fa-solid fa-cloud-arrow-up"
                                style="font-size: 2rem; color: var(--text-light);"></i>
                            <p style="margin-top: 1rem; color: var(--text-light);">
                                Drag and drop images here or
                                <label for="file-upload" style="color: var(--primary-color); cursor: pointer;">
                                    browse files
                                </label>
                            </p>
                            <input type="file" id="file-upload" name="file-upload" style="display: none;" multiple
                                accept="image/*">
                            <p style="font-size: 0.85rem; color: var(--text-light); margin-top: 0.5rem;">
                                Maximum 5 images, 5MB each (JPEG, PNG)
                            </p>
                        </div>
                        <div id="image-preview" style="display: flex; flex-wrap: wrap; gap: 1rem; margin-top: 1rem;">
                            <!-- Image previews will be added here -->
                        </div>
                    </div>

                    <div class="form-group">
                        <label for="assigned-to">Assign To (optional)</label>
                        <select id="assigned-to" name="assigned-to">
                            <option value="">Select a technician or leave unassigned</option>
                            <option value="jdoe">Elias Amro (Technician)</option>
                            <option value="asmith">Alice Smith (Repair)</option>
                            <option value="bjones">Bob Jones (Technician)</option>
                        </select>
                    </div>

                    <div style="display: flex; gap: 1rem; margin-top: 2rem;">
                        <button type="submit" class="btn btn-primary">Submit Fault Report</button>
                        <a href="machine-details.html?id=DRL8456" class="btn">Cancel</a>
                    </div>
                </form>
            </div>
        </div>
    </main>

    <!-- Footer -->
    <footer class="footer">
        <div class="footer-content">
            <div class="footer-logo">
                <img src="./static/images/logo.svg" alt="ACME Logo">
                <span>ACME Manufacturing Corp.</span>
            </div>
            <div class="footer-links">
                <a href="about.html">About</a>
                <a href="privacy.html">Privacy Policy</a>
                <a href="terms.html">Terms of Service</a>
                <a href="contact.html">Contact</a>
            </div>
            <div class="footer-copyright">
                &copy; 2025 ACME Manufacturing Corp. All rights reserved.
            </div>
        </div>
    </footer>

    <!-- Scripts -->
    <script src="./static/js/dynamic-menu.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', function () {
            // Form validation and submission
            const form = document.getElementById('fault-report-form');

            form.addEventListener('submit', function (e) {
                e.preventDefault();

                // Basic form validation
                const title = document.getElementById('fault-title').value.trim();
                const category = document.getElementById('fault-category').value;
                const description = document.getElementById('fault-description').value.trim();
                const priority = document.getElementById('fault-priority').value;

                let isValid = true;
                let errorMessage = '';

                if (!title) {
                    isValid = false;
                    errorMessage += 'Fault title is required.\n';
                }

                if (!category) {
                    isValid = false;
                    errorMessage += 'Please select a fault category.\n';
                }

                if (!description) {
                    isValid = false;
                    errorMessage += 'Detailed description is required.\n';
                }

                if (!priority) {
                    isValid = false;
                    errorMessage += 'Please select a priority level.\n';
                }

                if (isValid) {
                    // Simulate form submission
                    alert('Fault report submitted successfully! A case ID will be assigned and you will be redirected to the case details.');
                    window.location.href = 'fault-details.html?id=NEW-CASE';
                } else {
                    alert('Please correct the following errors:\n' + errorMessage);
                }
            });

            // File upload and preview functionality
            const fileUpload = document.getElementById('file-upload');
            const imagePreview = document.getElementById('image-preview');
            const dropZone = fileUpload.parentElement;

            // Handle file input change
            fileUpload.addEventListener('change', function () {
                handleFiles(this.files);
            });

            // Handle drag and drop
            dropZone.addEventListener('dragover', function (e) {
                e.preventDefault();
                dropZone.style.borderColor = "var('--primary-color')";
                dropZone.style.backgroundColor = 'rgba(37, 99, 235, 0.05)';
            });

            dropZone.addEventListener('dragleave', function () {
                dropZone.style.borderColor = '';
                dropZone.style.backgroundColor = '';
            });

            dropZone.addEventListener('drop', function (e) {
                e.preventDefault();
                dropZone.style.borderColor = '';
                dropZone.style.backgroundColor = '';

                if (e.dataTransfer.files.length) {
                    handleFiles(e.dataTransfer.files);
                }
            });

            // Process the selected files
            function handleFiles(files) {
                // Limit to 5 files
                const fileArray = Array.from(files).slice(0, 5);

                imagePreview.innerHTML = '';

                fileArray.forEach(file => {
                    if (!file.type.match('image.*')) {
                        return;
                    }

                    const reader = new FileReader();

                    reader.onload = function (e) {
                        const preview = document.createElement('div');
                        preview.className = 'image-preview-item';
                        preview.style.position = 'relative';
                        preview.style.width = '100px';
                        preview.style.height = '100px';

                        const img = document.createElement('img');
                        img.src = e.target.result;
                        img.style.width = '100%';
                        img.style.height = '100%';
                        img.style.objectFit = 'cover';
                        img.style.borderRadius = '8px';

                        const removeBtn = document.createElement('button');
                        removeBtn.innerHTML = '×';
                        removeBtn.style.position = 'absolute';
                        removeBtn.style.top = '-10px';
                        removeBtn.style.right = '-10px';
                        removeBtn.style.backgroundColor = 'white';
                        removeBtn.style.color = 'var(--danger-color)';
                        removeBtn.style.border = '1px solid var(--border-color)';
                        removeBtn.style.borderRadius = '50%';
                        removeBtn.style.width = '24px';
                        removeBtn.style.height = '24px';
                        removeBtn.style.cursor = 'pointer';
                        removeBtn.style.zIndex = '2';

                        removeBtn.addEventListener('click', function () {
                            preview.remove();
                        });

                        preview.appendChild(img);
                        preview.appendChild(removeBtn);

                        imagePreview.appendChild(preview);
                    };

                    reader.readAsDataURL(file);
                });
            }
        });
    </script>
</body>

</html>